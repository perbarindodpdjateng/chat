<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Live Chat Support</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .chat-container {
            width: 400px;
            height: 600px;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
            position: relative;
        }

        .chat-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .operator-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            color: #667eea;
        }

        .operator-info h3 {
            font-size: 16px;
            margin-bottom: 5px;
        }

        .status {
            font-size: 12px;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .status-dot {
            width: 8px;
            height: 8px;
            background: #4CAF50;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }

        .chat-messages {
            height: calc(100% - 140px);
            overflow-y: auto;
            padding: 20px;
            background: #f8f9fa;
        }

        .message {
            margin-bottom: 15px;
            display: flex;
            align-items: flex-end;
            gap: 10px;
            animation: slideIn 0.3s ease-out;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .message.user {
            flex-direction: row-reverse;
        }

        .message-bubble {
            max-width: 70%;
            padding: 12px 16px;
            border-radius: 18px;
            font-size: 14px;
            line-height: 1.4;
            position: relative;
        }

        .message.operator .message-bubble {
            background: white;
            border: 1px solid #e0e0e0;
            color: #333;
        }

        .message.user .message-bubble {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .message-time {
            font-size: 10px;
            color: #999;
            margin-top: 5px;
        }

        .chat-input {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: white;
            padding: 20px;
            border-top: 1px solid #e0e0e0;
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .input-field {
            flex: 1;
            padding: 12px 16px;
            border: 2px solid #e0e0e0;
            border-radius: 25px;
            outline: none;
            font-size: 14px;
            transition: border-color 0.3s;
        }

        .input-field:focus {
            border-color: #667eea;
        }

        .send-btn {
            width: 45px;
            height: 45px;
            border: none;
            border-radius: 50%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: transform 0.2s;
        }

        .send-btn:hover {
            transform: scale(1.05);
        }

        .send-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .typing-indicator {
            display: none;
            padding: 10px 20px;
            font-size: 12px;
            color: #666;
            font-style: italic;
        }

        .typing-indicator.active {
            display: block;
        }

        /* Responsive Design */
        @media (max-width: 480px) {
            .chat-container {
                width: 100%;
                height: 100vh;
                border-radius: 0;
            }
        }

        /* Scrollbar Styling */
        .chat-messages::-webkit-scrollbar {
            width: 6px;
        }

        .chat-messages::-webkit-scrollbar-track {
            background: #f1f1f1;
        }

        .chat-messages::-webkit-scrollbar-thumb {
            background: #ccc;
            border-radius: 3px;
        }

        .chat-messages::-webkit-scrollbar-thumb:hover {
            background: #999;
        }
    </style>
</head>
<body>
    <div class="chat-container">
        <div class="chat-header">
            <div class="operator-avatar">üë®‚Äçüíº</div>
            <div class="operator-info">
                <h3>Customer Service</h3>
                <div class="status">
                    <div class="status-dot"></div>
                    Online
                </div>
            </div>
        </div>
        
        <div class="chat-messages" id="chatMessages">
            <div class="message operator">
                <div class="message-bubble">
                    Halo! üëã Saya adalah operator customer service. Ada yang bisa saya bantu hari ini?
                </div>
            </div>
        </div>
        
        <div class="typing-indicator" id="typingIndicator">
            Operator sedang mengetik...
        </div>
        
        <div class="chat-input">
            <input 
                type="text" 
                class="input-field" 
                id="messageInput" 
                placeholder="Ketik pesan anda..."
                maxlength="500"
            >
            <button class="send-btn" id="sendBtn">
                ‚û§
            </button>
        </div>
    </div>

    <script>
        class LiveChat {
            constructor() {
                this.socket = null;
                this.userId = this.generateUserId();
                this.operatorId = 'operator_1';
                this.isConnected = false;
                
                this.initializeElements();
                this.setupEventListeners();
                this.connectToServer();
            }

            initializeElements() {
                this.chatMessages = document.getElementById('chatMessages');
                this.messageInput = document.getElementById('messageInput');
                this.sendBtn = document.getElementById('sendBtn');
                this.typingIndicator = document.getElementById('typingIndicator');
            }

            setupEventListeners() {
                this.sendBtn.addEventListener('click', () => this.sendMessage());
                this.messageInput.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') {
                        this.sendMessage();
                    } else {
                        this.sendTypingIndicator();
                    }
                });
            }

            generateUserId() {
                return 'user_' + Math.random().toString(36).substr(2, 9);
            }

            connectToServer() {
                // Simulasi koneksi WebSocket
                // Di production, ganti dengan koneksi WebSocket yang sesungguhnya
                this.simulateWebSocketConnection();
            }

            simulateWebSocketConnection() {
                this.isConnected = true;
                console.log('Terhubung ke server chat');
                
                // Simulasi pesan dari operator
                setTimeout(() => {
                    this.receiveMessage("Saya siap membantu anda. Silakan tanyakan apa saja!");
                }, 3000);
            }

            sendMessage() {
                const message = this.messageInput.value.trim();
                if (!message || !this.isConnected) return;

                // Tambahkan pesan user ke chat
                this.addMessageToChat(message, 'user');
                
                // Clear input
                this.messageInput.value = '';
                
                // Kirim ke server (simulasi)
                this.simulateSendToServer(message);
                
                // Disable tombol sementara
                this.sendBtn.disabled = true;
                setTimeout(() => {
                    this.sendBtn.disabled = false;
                }, 1000);
            }

            simulateSendToServer(message) {
                console.log('Mengirim pesan:', message);
                
                // Simulasi balasan operator
                setTimeout(() => {
                    this.showTypingIndicator();
                    
                    setTimeout(() => {
                        this.hideTypingIndicator();
                        const responses = [
                            "Terima kasih atas pertanyaannya. Saya akan bantu segera.",
                            "Baik, saya mengerti. Apakah ada detail lain yang ingin anda sampaikan?",
                            "Saya akan cek informasi tersebut untuk anda.",
                            "Untuk kasus seperti ini, saya sarankan...",
                            "Apakah ada hal lain yang bisa saya bantu?"
                        ];
                        const randomResponse = responses[Math.floor(Math.random() * responses.length)];
                        this.receiveMessage(randomResponse);
                    }, 2000);
                }, 1000);
            }

            receiveMessage(message) {
                this.addMessageToChat(message, 'operator');
            }

            addMessageToChat(message, sender) {
                const messageDiv = document.createElement('div');
                messageDiv.className = `message ${sender}`;
                
                const time = new Date().toLocaleTimeString('id-ID', {
                    hour: '2-digit',
                    minute: '2-digit'
                });
                
                messageDiv.innerHTML = `
                    <div class="message-bubble">
                        ${message}
                        <div class="message-time">${time}</div>
                    </div>
                `;
                
                this.chatMessages.appendChild(messageDiv);
                this.scrollToBottom();
            }

            showTypingIndicator() {
                this.typingIndicator.classList.add('active');
                this.scrollToBottom();
            }

            hideTypingIndicator() {
                this.typingIndicator.classList.remove('active');
            }

            sendTypingIndicator() {
                // Kirig indikator typing ke server
                // Implementasi sesuai kebutuhan
            }

            scrollToBottom() {
                this.chatMessages.scrollTop = this.chatMessages.scrollHeight;
            }
        }

        // Inisialisasi chat saat halaman dimuat
        document.addEventListener('DOMContentLoaded', () => {
            new LiveChat();
        });
    </script>
</body>
</html>
